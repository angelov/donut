services:

    # repositories

    app.friendships.friendship_requests.repositories.default: '@app.friendships.friendship_requests.repositories.doctrine'

    app.friendships.friendship_requests.repositories.doctrine:
        class: 'SocNet\Friendships\FriendshipRequests\Repositories\DoctrineFriendshipRequestsRepository'
        arguments: ['@doctrine.orm.entity_manager']

    app.friendships.repositories.default: '@app.friendships.repositories.doctrine'

    app.friendships.repositories.doctrine:
        class: 'SocNet\Friendships\Repositories\DoctrineFriendshipsRepository'
        arguments: ['@doctrine.orm.entity_manager']


    # handlers

    app.friendships.friendship_requests.handlers.send:
        class: 'SocNet\Friendships\FriendshipRequests\Handlers\SendFriendshipRequestCommandHandler'
        arguments: ['@app.friendships.friendship_requests.repositories.default']
        tags:
            - { name: 'command_handler', handles: 'SocNet\Friendships\FriendshipRequests\Commands\SendFriendshipRequestCommand' }

    app.friendships.friendship_requests.handlers.cancel:
        class: 'SocNet\Friendships\FriendshipRequests\Handlers\CancelFriendshipRequestCommandHandler'
        arguments: ['@app.friendships.friendship_requests.repositories.default']
        tags:
            - { name: 'command_handler', handles: 'SocNet\Friendships\FriendshipRequests\Commands\CancelFriendshipRequestCommand' }

    app.friendships.friendship_requests.handlers.decline:
        class: 'SocNet\Friendships\FriendshipRequests\Handlers\DeclineFriendshipRequestCommandHandler'
        arguments: ['@app.friendships.friendship_requests.repositories.default']
        tags:
            - { name: 'command_handler', handles: 'SocNet\Friendships\FriendshipRequests\Commands\DeclineFriendshipRequestCommand' }

    app.friendships.friendship_requests.handlers.accept:
        class: 'SocNet\Friendships\FriendshipRequests\Handlers\AcceptFriendshipRequestCommandHandler'
        arguments: ['@app.friendships.friendship_requests.repositories.default', '@app.friendships.repositories.default', '@app.core.event_bus.default']
        tags:
            - { name: 'command_handler', handles: 'SocNet\Friendships\FriendshipRequests\Commands\AcceptFriendshipRequestCommand' }

    app.friendships.handlers.delete:
        class: 'SocNet\Friendships\Handlers\DeleteFriendshipCommandHandler'
        arguments: ['@app.friendships.repositories.default']
        tags:
            - { name: 'command_handler', handles: 'SocNet\Friendships\Commands\DeleteFriendshipCommand' }


    # event subscribers

    app.friendships.event_subsribers.record_created_friendship:
        class: 'SocNet\Friendships\EventSubscribers\RecordCreatedFriendship'
        arguments: ['@app.friendships.friendships_recorder.neo4j']
        tags:
            - { name: 'event_subscriber', subscribes_to: 'SocNet\Friendships\Events\FriendshipWasCreatedEvent' }


    # friendships recorder

    app.friendships.friendships_recorder.neo4j:
        class: 'SocNet\Friendships\FriendshipsRecorder\Neo4jFriendshipsRecorder'
        arguments: ['@neo4j.client.default']
