services:

    # repositories

    app.communities.repositories.default: '@app.communities.repositories.doctrine'

    app.communities.repositories.doctrine:
        class: 'Angelov\Donut\Communities\Repositories\DoctrineCommunitiesRepository'
        arguments: ['@doctrine.orm.entity_manager']


    # form

    app.communities.form.community_type:
        class: 'Angelov\Donut\Communities\Form\CommunityType'
        arguments: ['@app.users.security.current_user', '@app.core.uuid_generator']
        tags:
            - { name: 'form.type' }


    # command handlers

    app.communities.handlers.store:
        class: 'Angelov\Donut\Communities\Handlers\StoreCommunityCommandHandler'
        arguments: ['@app.communities.repositories.default', '@app.users.repository.default']
        tags:
            - { name: 'command_handler', handles: 'Angelov\Donut\Communities\Commands\StoreCommunityCommand' }

    app.communities.handlers.join:
        class: 'Angelov\Donut\Communities\Handlers\JoinCommunityCommandHandler'
        arguments: ['@app.communities.repositories.default', '@app.users.repository.default']
        tags:
            - { name: 'command_handler', handles: 'Angelov\Donut\Communities\Commands\JoinCommunityCommand' }

    app.communities.handlers.leave:
        class: 'Angelov\Donut\Communities\Handlers\LeaveCommunityCommandHandler'
        arguments: ['@app.communities.repositories.default', '@app.users.repository.default']
        tags:
            - { name: 'command_handler', handles: 'Angelov\Donut\Communities\Commands\LeaveCommunityCommand' }
